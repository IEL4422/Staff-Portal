<analysis>**original_problem_statement:**
Build a staff portal for Illinois Estate Law, a law firm specializing in estate planning and probate. This client management system should integrate with Airtable as its primary database.

**PRODUCT REQUIREMENTS:**
-   **UI:** Modern, simple, visually pleasing with elements of the color #2E7DA1 and rounded components.
-   **Authentication:** Secure user login with a specific admin role for .
-   **Sidebar Actions:**
    -   Phone call intake (Tally form).
    -   Send Case Update (form to add to 'Case Updates' table).
    -   Send Mail (form to add to 'mail' table).
    -   Send Invoice (form to add to 'invoice' table).
    -   Add Task (form to add to 'tasks' table).
    -   Add Date/Deadline.
    -   Upload File (form to add to 'Document' table).
    -   Add Case Contact.
    -   Add Lead (form to add to 'master list').
    -   Add Client (form to add to 'master list').
    -   Add Asset/Debt (form to add to 'Assets & Debts' table).
-   **Homepage/Dashboard:** Search for the 'master list', show upcoming consultations/deadlines, and display a clickable Total Active Cases card.
-   **Clients Page:** Filter cases by type (Probate, Estate Planning, Deed, All). Add a button to create a new client. Display probate task progress.
-   **Leads Page:** Display the 'Type of Lead' for each record. Add a button to create a new lead.
-   **Tasks Page:** Show tasks for the logged-in user with status statistics. Allow tasks to be marked as Done with a single click from the 'Not Started' list.
-   **Case Detail Pages (Probate & Estate Planning):** Show linked documents, tasks, call logs, and contacts. Add an editable 'Staff Notes' field.
-   **Judge Information Page:** Redesigned two-row layout with a detail modal. The modal should support editing and show a clickable list of linked cases. Add functionality to create new judges and link them to cases.
-   **Payments Page:** Show a Payments with Missing Information section for active, non-lead cases that are missing an 'Amount Paid' and/or 'Date Paid'. Allow the amount to be edited in this view.

**User's preferred language**: English

**what currently exists?**
The project is a full-stack staff portal using React, FastAPI, and Airtable, with MongoDB for specific features like task completion dates and user credentials. It has JWT-based authentication with a designated admin role.

The application includes:
-   A full suite of pages: Dashboard, Clients, Leads, Tasks, and Judge Info.
-   A  with numerous action forms, including , , , , and .
-   The  and  now feature filtering and Add buttons that launch modals.
-   The  has been completely overhauled with a new layout, a feature-rich detail modal (with edit mode and linked case display), and forms for adding new judges and linking them to matters.
-    and  pages now fetch and display linked records (tasks, calls, etc.) and include an editable Staff Notes field.
-   The  has a Payments with Missing Information section that allows for editing the amount and setting the payment date.
-   The  allows users to mark a Not Started task as Done with a single click.

**Last working item**:
-   **Last item agent was working**: The agent was implementing the Add Asset/Debt form requested by the user. The backend endpoint, frontend API service, and the React page component have all been created. The agent was just about to add the new route to  to make the page accessible.
-   **Status**: IN PROGRESS
-   **Agent Testing Done**: N
-   **Which testing method agent to use?**: manual testing by curl
-   **User Testing Done**: N

**All Pending/In progress Issue list**:
-   **Issue 1: Pre-existing Linting Errors (P2)**
    -   **Issues Detail:**
        -   **Attempted fixes:** None in this session.
        -   **Next debug checklist:** Run  in the frontend directory. Focus on fixing dependency array warnings for  and  in large components like , , and .
        -   **Why fix this issue and what will be achieved with the fix?** To improve code quality, prevent potential bugs from stale closures, and reduce unnecessary re-renders.
        -   **Status:** NOT STARTED
        -   **Is recurring issue?** Y
        -   **Should Test frontend/backend/both after fix?** frontend
        -   **Blocked on other issue:** None
-   **Issue 2: Airtable Schema Mismatches (P1)**
    -   **Issues Detail:**
        -   **Attempted fixes:** The agent encountered this when  was used instead of . The fix was to correct the field name in the backend code.
        -   **Next debug checklist:** Before implementing UI for Airtable fields (especially  or formula fields), always confirm the exact field names via API exploration or checking the Airtable base directly.
        -   **Why fix this issue and what will be achieved with the fix?** Prevents common  errors, reducing runtime bugs and rework.
        -   **Status:** RECURRING
        -   **Is recurring issue?** Y
        -   **Should Test frontend/backend/both after fix?** backend
        -   **Blocked on other issue:** None

**In progress Task List**:
-   **Task 1: Complete 'Add Asset/Debt' Form Implementation (P0)**
    -   **Task Detail:**
        -   **Where to resume:** Add the new route for the  to the main router file at .
        -   **What will be achieved with this?** A new sidebar form will be available for users to add asset and debt records to the Airtable base.
        -   **Status:** IN PROGRESS
        -   **Should Test frontend/backend/both after fix?** both
        -   **Blocked on something:** None

**Upcoming and Future Tasks**
**Upcoming Tasks:**
-   **Implement Deed Detail Page (P1):** This page is currently a placeholder (). It needs to be implemented with functionality similar to the Probate and Estate Planning pages, including a progress bar and inline editing. The specific stages and fields must be determined from Airtable.
-   **Implement Remaining Sidebar Action Forms (P2):**
    -    (form for 'mail' table).
    -   .
    -   .

**Future Tasks:**
-   **Implement Webhook Actions (P2):** The original request mentioned webhooks for 'Send case update' and 'Upload file to client portal'. While forms have been built, the webhook functionality itself has not been implemented.

**Completed work in this session**
-   **Judge Information Page Overhaul:** Fully redesigned the page with a two-row card layout and a detail modal.
-   **Judge Management Features:** Added Add Judge and Link Record functionalities. The detail modal was enhanced with an Edit mode and a clickable, expandable list of linked cases.
-   **Tasks Page Enhancement:** Implemented a Mark as Done feature by making the status circle on 'Not Started' tasks clickable.
-   **Clients Page Filtering:** Added filter buttons (, , , ) to filter the client list.
-   **Client Creation Modal:** Added an Add Client button to the Clients page header, launching a creation modal.
-   **Lead Creation Modal:** Added an Add Lead button to the Leads page header, launching a creation modal.
-   **Detail Page Enhancements:** Added an editable Staff Notes field to both  and . Fixed linked data fetching on the Estate Planning page.
-   **Payments Page Update:** Renamed Payments without Date to Payments with Missing Information and implemented functionality to edit the 'Amount Paid' field directly in the table.
-   **New Sidebar Forms Implemented:**
    -   
    -   
    -   
    -   
    -   

**Earlier issues found/mentioned but not fixed**
-   **Issue 1: Pre-existing Linting Errors**
    -   **Debug checklist:** Run  in the frontend directory.
    -   **Why to solve this issue and what will be achieved with this?** Improves code quality and prevents potential bugs from stale closures.
    -   **Should Test frontend/backend/both after fix:** frontend
    -   **Is recurring issue?** Y
-   **Issue 2: Component Refactoring**
    -   **Debug checklist:** Components like , , and  are very large. Sub-components (modals, trackers, etc.) should be extracted into their own files.
    -   **Why to solve this issue and what will be achieved with this?** Improves code readability, maintainability, and reusability.
    -   **Should Test frontend/backend/both after fix:** frontend
    -   **Is recurring issue?** Y

**Known issue recurrence from previous fork**
-   None.

**Code Architecture**


**Key Technical Concepts**
-   **Frontend:** React, Tailwind CSS, Shadcn UI.
-   **Backend:** FastAPI (Python).
-   **Databases:** Airtable (primary), MongoDB (task completion dates, user credentials).
-   **Authentication:** JWT with a special case for an admin role.
-   **State Management:** React Hooks (, , ) and  for session persistence.

**key DB schema**
-   **Airtable **: , , , , , , , , , , , , , .
-   **Airtable **: , , , , , , ,  (Linked to Master List).
-   **Airtable **: ,  (Linked),  (Attachment).
-   **Airtable **: , ,  (Linked), .
-   **Airtable **: ,  (Linked), ,  (Attachment).
-   **Airtable **: , , , , , , ,  (Linked), .

**changes in tech stack**
-   None.

**All files of reference**
-   : Last file created.
-   : Updated to add the 'Add Asset/Debt' link.
-   : Needs to be updated with the route for .
-   : Heavily modified with new endpoints for judges, case updates, assets/debts, and logic changes for payments.
-   : Heavily modified with new layout, modals, and logic.
-   : Modified to add filters and an Add Client modal.
-   : Modified to add an Add Lead modal.
-   : Modified to add the mark as done feature.
-   : Modified to allow editing amounts and update section logic.
-   , : Updated to add Staff Notes and fix data fetching.
-   : Multiple form pages were created/overwritten in this directory.

**Areas that need refactoring**:
-   **Monolithic Components:** , , and  are excessively large. They should be broken down by extracting sub-components (modals, forms, list items) into separate files in the  directory.
-   **Monolithic Backend:**  is responsible for all API routes. It should be refactored into a modular structure using FastAPI's  for different resources (e.g., , ).

**key api endpoints**
-   : Creates a new judge record.
-   : Links a matter to a judge.
-   : Updates a judge's details.
-   : Creates a new case update record.
-   : Creates a new asset/debt record.
-   : Updated to fetch active, non-lead cases missing payment info.
-   : Updated to handle amount paid updates.

**Critical Info for New Agent**
-   **Airtable Schema Rigidity:** Be extremely cautious with Airtable field names.  is the correct field name, not . An incorrect field name in a filter formula will cause a  error. Always verify field names before coding.
-   **Component Refactoring Urgency:** The main pages have become very complex and difficult to manage. Before adding significant new features, it is highly recommended to refactor large components by extracting sub-components into their own files.
-   **Admin User:** The admin user is  with password . This user has access to special features like the Payments page.

**documents and test reports created in this job**
-   : Updated multiple times to guide the testing agent.

**Last 10 User Messages and any pending HUMAN messages**
1.  **(IN PROGRESS)** Add to Left Side Bar: Add Asset/Debt...
2.  **(COMPLETED)** For Upload File... Send Invoice... Send Case Update on the left sidebar...
3.  **(COMPLETED)** on the clients list page add a button to add client...
4.  **(COMPLETED)** For the Add Client on left sidebar, it should be a form that adds a record to Master List...
5.  **(COMPLETED)** On the payments page, allow the amount to be edited... Change the title... On the Add Lead... add a button to Add Lead...
6.  **(COMPLETED)** on the payments page, add to Payments without Date if Type of Case is Not Lead...
7.  **(COMPLETED)** on the estate planning details pages, make sure to show the documents, tasks... put the field Staff Notes
8.  **(COMPLETED)** on the tasks page, for the not started tasks. when the circle is clicked change the task status to Done... on the clients page have button filters...
9.  **(COMPLETED)** in the judge information page when a record is clicked to the detail popup, have an edit button... When the cases... is clicked, it shows a list of the cases...
10. **(COMPLETED)** add a button at the top of the judge information page to add a new judge... on each judge record add a button to Link Record...

**Project Health Check:**
-   **Broken:** None.
-   **Mocked:**  page is still a placeholder. Sidebar actions for , , and  are unimplemented placeholders.

**3rd Party Integrations**
-   **Airtable**: Primary database.
-   **Tally.so**: Embedded form for Phone Call Intake.
-   **MongoDB**: Used for user credentials and probate task completion dates.
-   **Zapier**: Mentioned for a single webhook.

**Testing status**
-   **Testing agent used after significant changes:** YES (Agent used ).
-   **Troubleshoot agent used after agent stuck in loop:** NO
-   **Test files created:** None
-   **Known regressions:** The testing agent initially failed to find the Add Lead button, but a manual screenshot confirmed it was present, suggesting a possible timing issue with the test script rather than a regression.

**Credentials to test flow:**
-   **Admin:**  / 
-   **Regular User:**  / 

**What agent forgot to execute**
-   **Finalize 'Add Asset/Debt'**: The agent created the page but did not add the corresponding route to  to make it accessible.
-   **Linting Errors:** Pre-existing linting warnings were acknowledged in the previous handoff but never fixed.
-   **Deed Detail Page:** This page remains a placeholder and was not implemented.
-   **Refactoring:** Despite being flagged as urgent in the initial handoff, no refactoring of large components or the backend was performed.</analysis>
